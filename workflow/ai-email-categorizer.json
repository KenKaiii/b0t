{
  "version": "1.0",
  "name": "AI Email Categorizer",
  "description": "Automatically categorize emails using AI into action, junk, receipt, SaaS, community, business, or other categories",
  "trigger": {
    "type": "manual",
    "config": {}
  },
  "config": {
    "steps": [
      {
        "id": "createSampleEmails",
        "module": "utilities.array-utils.zipToObjects",
        "inputs": {
          "fieldArrays": {
            "id": [1, 2, 3, 4, 5],
            "from": [
              "sales@techvendor.com",
              "support@github.com",
              "orders@amazon.com",
              "community@devto.com",
              "john.doe@acmecorp.com"
            ],
            "subject": [
              "Limited Time Offer: 50% Off Enterprise Plan!",
              "Security Alert: New login detected",
              "Your order has been shipped",
              "Weekly Community Digest - Top Articles",
              "Re: Project proposal discussion"
            ],
            "body": [
              "Hey there! Don't miss out on our amazing deal. Click here now to save big on our enterprise plan. This offer expires in 24 hours!",
              "We detected a new login to your GitHub account from a new device in San Francisco, CA. If this wasn't you, please secure your account immediately.",
              "Good news! Your Amazon order #123-456789 has been shipped and will arrive by Friday. Track your package using the link below.",
              "Check out this week's top articles from the community: Building Better APIs, Microservices at Scale, and more. Join the discussion!",
              "Hi, following up on our conversation about the new project. I've reviewed the proposal and have some feedback. Can we schedule a call this week?"
            ],
            "importance": ["normal", "high", "normal", "normal", "high"]
          }
        },
        "outputAs": "sampleEmails"
      },
      {
        "id": "categorizeEmail1",
        "module": "ai.ai-sdk.generateText",
        "inputs": {
          "options": {
            "prompt": "Categorize the following email. Return ONLY valid JSON, no other text:\n\nFrom: {{sampleEmails.0.from}}\nSubject: {{sampleEmails.0.subject}}\nBody: {{sampleEmails.0.body}}\nImportance: {{sampleEmails.0.importance}}\n\nCategories available:\n- action: Needs response or action (includes some SaaS emails), avoid sales emails but include enquiries\n- junk: Ads, sales, newsletters, promotions, daily digests (emojis often indicate junk), phishing, scams, discounts\n- receipt: Any purchase confirmation\n- saas: Account/security updates (unless action required), generic SaaS information, usually from non-personal email\n- community: Updates, events, forums, everything related to community\n- business: Communication related to work, usually from a human's email address\n- other: Doesn't fit into any other category\n\nResponse format (JSON only):\n{\n  \"category\": \"one of: action, junk, receipt, saas, community, business, other\",\n  \"subCategory\": \"optional sub-category\",\n  \"analysis\": \"brief 1-2 sentence explanation\"\n}",
            "model": "gpt-4o-mini",
            "provider": "openai",
            "temperature": 0.3
          }
        },
        "outputAs": "category1Raw"
      },
      {
        "id": "parseCategory1",
        "module": "utilities.json-transform.parseJson",
        "inputs": {
          "jsonString": "{{category1Raw.content}}"
        },
        "outputAs": "category1"
      },
      {
        "id": "categorizeEmail2",
        "module": "ai.ai-sdk.generateText",
        "inputs": {
          "options": {
            "prompt": "Categorize the following email. Return ONLY valid JSON, no other text:\n\nFrom: {{sampleEmails.1.from}}\nSubject: {{sampleEmails.1.subject}}\nBody: {{sampleEmails.1.body}}\nImportance: {{sampleEmails.1.importance}}\n\nCategories available:\n- action: Needs response or action (includes some SaaS emails), avoid sales emails but include enquiries\n- junk: Ads, sales, newsletters, promotions, daily digests (emojis often indicate junk), phishing, scams, discounts\n- receipt: Any purchase confirmation\n- saas: Account/security updates (unless action required), generic SaaS information, usually from non-personal email\n- community: Updates, events, forums, everything related to community\n- business: Communication related to work, usually from a human's email address\n- other: Doesn't fit into any other category\n\nResponse format (JSON only):\n{\n  \"category\": \"one of: action, junk, receipt, saas, community, business, other\",\n  \"subCategory\": \"optional sub-category\",\n  \"analysis\": \"brief 1-2 sentence explanation\"\n}",
            "model": "gpt-4o-mini",
            "provider": "openai",
            "temperature": 0.3
          }
        },
        "outputAs": "category2Raw"
      },
      {
        "id": "parseCategory2",
        "module": "utilities.json-transform.parseJson",
        "inputs": {
          "jsonString": "{{category2Raw.content}}"
        },
        "outputAs": "category2"
      },
      {
        "id": "categorizeEmail3",
        "module": "ai.ai-sdk.generateText",
        "inputs": {
          "options": {
            "prompt": "Categorize the following email. Return ONLY valid JSON, no other text:\n\nFrom: {{sampleEmails.2.from}}\nSubject: {{sampleEmails.2.subject}}\nBody: {{sampleEmails.2.body}}\nImportance: {{sampleEmails.2.importance}}\n\nCategories available:\n- action: Needs response or action (includes some SaaS emails), avoid sales emails but include enquiries\n- junk: Ads, sales, newsletters, promotions, daily digests (emojis often indicate junk), phishing, scams, discounts\n- receipt: Any purchase confirmation\n- saas: Account/security updates (unless action required), generic SaaS information, usually from non-personal email\n- community: Updates, events, forums, everything related to community\n- business: Communication related to work, usually from a human's email address\n- other: Doesn't fit into any other category\n\nResponse format (JSON only):\n{\n  \"category\": \"one of: action, junk, receipt, saas, community, business, other\",\n  \"subCategory\": \"optional sub-category\",\n  \"analysis\": \"brief 1-2 sentence explanation\"\n}",
            "model": "gpt-4o-mini",
            "provider": "openai",
            "temperature": 0.3
          }
        },
        "outputAs": "category3Raw"
      },
      {
        "id": "parseCategory3",
        "module": "utilities.json-transform.parseJson",
        "inputs": {
          "jsonString": "{{category3Raw.content}}"
        },
        "outputAs": "category3"
      },
      {
        "id": "categorizeEmail4",
        "module": "ai.ai-sdk.generateText",
        "inputs": {
          "options": {
            "prompt": "Categorize the following email. Return ONLY valid JSON, no other text:\n\nFrom: {{sampleEmails.3.from}}\nSubject: {{sampleEmails.3.subject}}\nBody: {{sampleEmails.3.body}}\nImportance: {{sampleEmails.3.importance}}\n\nCategories available:\n- action: Needs response or action (includes some SaaS emails), avoid sales emails but include enquiries\n- junk: Ads, sales, newsletters, promotions, daily digests (emojis often indicate junk), phishing, scams, discounts\n- receipt: Any purchase confirmation\n- saas: Account/security updates (unless action required), generic SaaS information, usually from non-personal email\n- community: Updates, events, forums, everything related to community\n- business: Communication related to work, usually from a human's email address\n- other: Doesn't fit into any other category\n\nResponse format (JSON only):\n{\n  \"category\": \"one of: action, junk, receipt, saas, community, business, other\",\n  \"subCategory\": \"optional sub-category\",\n  \"analysis\": \"brief 1-2 sentence explanation\"\n}",
            "model": "gpt-4o-mini",
            "provider": "openai",
            "temperature": 0.3
          }
        },
        "outputAs": "category4Raw"
      },
      {
        "id": "parseCategory4",
        "module": "utilities.json-transform.parseJson",
        "inputs": {
          "jsonString": "{{category4Raw.content}}"
        },
        "outputAs": "category4"
      },
      {
        "id": "categorizeEmail5",
        "module": "ai.ai-sdk.generateText",
        "inputs": {
          "options": {
            "prompt": "Categorize the following email. Return ONLY valid JSON, no other text:\n\nFrom: {{sampleEmails.4.from}}\nSubject: {{sampleEmails.4.subject}}\nBody: {{sampleEmails.4.body}}\nImportance: {{sampleEmails.4.importance}}\n\nCategories available:\n- action: Needs response or action (includes some SaaS emails), avoid sales emails but include enquiries\n- junk: Ads, sales, newsletters, promotions, daily digests (emojis often indicate junk), phishing, scams, discounts\n- receipt: Any purchase confirmation\n- saas: Account/security updates (unless action required), generic SaaS information, usually from non-personal email\n- community: Updates, events, forums, everything related to community\n- business: Communication related to work, usually from a human's email address\n- other: Doesn't fit into any other category\n\nResponse format (JSON only):\n{\n  \"category\": \"one of: action, junk, receipt, saas, community, business, other\",\n  \"subCategory\": \"optional sub-category\",\n  \"analysis\": \"brief 1-2 sentence explanation\"\n}",
            "model": "gpt-4o-mini",
            "provider": "openai",
            "temperature": 0.3
          }
        },
        "outputAs": "category5Raw"
      },
      {
        "id": "parseCategory5",
        "module": "utilities.json-transform.parseJson",
        "inputs": {
          "jsonString": "{{category5Raw.content}}"
        },
        "outputAs": "category5"
      },
      {
        "id": "combineResults",
        "module": "utilities.array-utils.zipToObjects",
        "inputs": {
          "fieldArrays": {
            "emailId": [1, 2, 3, 4, 5],
            "from": [
              "{{sampleEmails.0.from}}",
              "{{sampleEmails.1.from}}",
              "{{sampleEmails.2.from}}",
              "{{sampleEmails.3.from}}",
              "{{sampleEmails.4.from}}"
            ],
            "subject": [
              "{{sampleEmails.0.subject}}",
              "{{sampleEmails.1.subject}}",
              "{{sampleEmails.2.subject}}",
              "{{sampleEmails.3.subject}}",
              "{{sampleEmails.4.subject}}"
            ],
            "category": [
              "{{category1.category}}",
              "{{category2.category}}",
              "{{category3.category}}",
              "{{category4.category}}",
              "{{category5.category}}"
            ],
            "subCategory": [
              "{{category1.subCategory}}",
              "{{category2.subCategory}}",
              "{{category3.subCategory}}",
              "{{category4.subCategory}}",
              "{{category5.subCategory}}"
            ],
            "analysis": [
              "{{category1.analysis}}",
              "{{category2.analysis}}",
              "{{category3.analysis}}",
              "{{category4.analysis}}",
              "{{category5.analysis}}"
            ]
          }
        },
        "outputAs": "categorizedEmails"
      }
    ],
    "returnValue": "{{categorizedEmails}}",
    "outputDisplay": {
      "type": "table",
      "columns": [
        {
          "key": "emailId",
          "label": "ID",
          "type": "number"
        },
        {
          "key": "from",
          "label": "From",
          "type": "text"
        },
        {
          "key": "subject",
          "label": "Subject",
          "type": "text"
        },
        {
          "key": "category",
          "label": "Category",
          "type": "text"
        },
        {
          "key": "subCategory",
          "label": "Sub-Category",
          "type": "text"
        },
        {
          "key": "analysis",
          "label": "Analysis",
          "type": "text"
        }
      ]
    }
  },
  "metadata": {
    "requiresCredentials": ["openai"]
  }
}
