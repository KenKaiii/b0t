{
  "version": "1.0",
  "name": "Outlook Trigger Test",
  "description": "Test Outlook email trigger - adds 'Processed' category to new emails",
  "trigger": {
    "type": "outlook",
    "config": {
      "filters": {
        "folder": "inbox",
        "isUnread": true
      },
      "pollInterval": 60
    }
  },
  "config": {
    "steps": [
      {
        "id": "addCategory",
        "module": "communication.outlook.addCategories",
        "inputs": {
          "params": {
            "userId": "{{trigger.userId}}",
            "emailId": "{{trigger.email.id}}",
            "categories": [
              "Processed"
            ]
          }
        },
        "outputAs": "result"
      }
    ]
  },
  "metadata": {
    "requiresCredentials": [
      "outlook"
    ]
  }
}
